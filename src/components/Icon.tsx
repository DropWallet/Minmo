import React from 'react';
import Svg, { Path, G } from 'react-native-svg';
import { useTheme } from '@hooks/useTheme';

interface IconProps {
  name: string;
  size?: number;
  color?: string; // Can be a theme color key (e.g., 'textPrimary', 'accent') or a hex color
  style?: any;
}

// Convert paths to functions that accept color
const iconPaths: Record<string, { viewBox: string; paths: (color: string) => React.ReactNode }> = {
  'ic-close': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <Path
        d="M3.05288 17.1929C2.09778 16.2704 1.33596 15.167 0.811868 13.9469C0.287778 12.7269 0.0119157 11.4147 0.000377568 10.0869C-0.0111606 8.7591 0.241856 7.44231 0.744665 6.21334C1.24747 4.98438 1.99001 3.86786 2.92893 2.92893C3.86786 1.99001 4.98438 1.24747 6.21334 0.744665C7.44231 0.241856 8.7591 -0.0111606 10.0869 0.000377568C11.4147 0.0119157 12.7269 0.287778 13.9469 0.811868C15.167 1.33596 16.2704 2.09778 17.1929 3.05288C19.0145 4.9389 20.0224 7.46493 19.9996 10.0869C19.9768 12.7089 18.9251 15.217 17.0711 17.0711C15.217 18.9251 12.7089 19.9768 10.0869 19.9996C7.46493 20.0224 4.9389 19.0145 3.05288 17.1929ZM11.5229 10.1229L14.3529 7.29288L12.9429 5.88288L10.1229 8.71288L7.29288 5.88288L5.88288 7.29288L8.71288 10.1229L5.88288 12.9529L7.29288 14.3629L10.1229 11.5329L12.9529 14.3629L14.3629 12.9529L11.5329 10.1229H11.5229Z"
        fill={color}
      />
    ),
  },
  'ic-stop': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <G opacity="0.6">
        <Path
          d="M0 6C0 2.68629 2.68629 0 6 0H14C17.3137 0 20 2.68629 20 6V14C20 17.3137 17.3137 20 14 20H6C2.68629 20 0 17.3137 0 14V6Z"
          fill={color}
        />
      </G>
    ),
  },
  'ic-add': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <Path
        d="M10 0C4.477 0 0 4.477 0 10C0 15.523 4.477 20 10 20C15.523 20 20 15.523 20 10C20 4.477 15.523 0 10 0ZM15 11H11V15H9V11H5V9H9V5H11V9H15V11Z"
        fill={color}
      />
    ),
  },
  'ic-play': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <Path
        d="M10 0C8.02219 0 6.08879 0.58649 4.4443 1.6853C2.79981 2.78412 1.51809 4.3459 0.761209 6.17317C0.00433284 8.00043 -0.193701 10.0111 0.192152 11.9509C0.578004 13.8907 1.53041 15.6725 2.92894 17.0711C4.32746 18.4696 6.10929 19.422 8.0491 19.8079C9.98891 20.1937 11.9996 19.9957 13.8268 19.2388C15.6541 18.4819 17.2159 17.2002 18.3147 15.5557C19.4135 13.9112 20 11.9778 20 10C20 8.68678 19.7413 7.38642 19.2388 6.17317C18.7363 4.95991 17.9997 3.85752 17.0711 2.92893C16.1425 2.00035 15.0401 1.26375 13.8268 0.761205C12.6136 0.258658 11.3132 0 10 0ZM8 14.5V5.5L14 10L8 14.5Z"
        fill={color}
      />
    ),
  },
  'ic-pause': {
  viewBox: '0 0 20 20',
  paths: (color) => (
    <Path
      d="M10 0C4.477 0 0 4.477 0 10C0 15.523 4.477 20 10 20C15.523 20 20 15.523 20 10C20 4.477 15.523 0 10 0ZM9 14H7V6H9V14ZM13 14H11V6H13V14Z"
      fill={color}
    />
  ),
},
  'ic-tick': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <Path
        d="M10 0C4.5 0 0 4.5 0 10C0 15.5 4.5 20 10 20C15.5 20 20 15.5 20 10C20 4.5 15.5 0 10 0ZM8 15L3 10L4.41 8.59L8 12.17L15.59 4.58L17 6L8 15Z"
        fill={color}
      />
    ),
  },
  'ic-edit': {
    viewBox: '0 0 18 20',
    paths: (color) => (
      <Path
        d="M15.675 0.887176C15.3938 0.605833 15.0599 0.382668 14.6924 0.230441C14.325 0.078213 13.9311 -9.27894e-05 13.5333 8.25137e-08C13.1355 9.29544e-05 12.7417 0.0785826 12.3743 0.230982C12.0068 0.383381 11.6731 0.606702 11.392 0.888176L1.885 10.4082C1.31853 10.9759 1.00028 11.7451 1 12.5472V15.7502C1 16.1642 1.336 16.5002 1.75 16.5002H4.973C5.776 16.5002 6.546 16.1802 7.113 15.6132L16.613 6.10718C17.1797 5.53915 17.4979 4.76954 17.4979 3.96718C17.4979 3.16481 17.1797 2.3952 16.613 1.82718L15.675 0.887176ZM0.75 18.0002C0.551088 18.0002 0.360322 18.0792 0.21967 18.2198C0.0790175 18.3605 0 18.5513 0 18.7502C0 18.9491 0.0790175 19.1399 0.21967 19.2805C0.360322 19.4212 0.551088 19.5002 0.75 19.5002H16.75C16.9489 19.5002 17.1397 19.4212 17.2803 19.2805C17.421 19.1399 17.5 18.9491 17.5 18.7502C17.5 18.5513 17.421 18.3605 17.2803 18.2198C17.1397 18.0792 16.9489 18.0002 16.75 18.0002H0.75Z"
        fill={color}
      />
    ),
  },
  'ic-delete': {
    viewBox: '0 0 18 20',
    paths: (color) => (
      <Path
        d="M17 3C17.2652 3 17.5196 3.10536 17.7071 3.29289C17.8946 3.48043 18 3.73478 18 4C18 4.26522 17.8946 4.51957 17.7071 4.70711C17.5196 4.89464 17.2652 5 17 5H16L15.997 5.071L15.064 18.142C15.0281 18.6466 14.8023 19.1188 14.4321 19.4636C14.0619 19.8083 13.5749 20 13.069 20H4.93C4.42414 20 3.93707 19.8083 3.56688 19.4636C3.1967 19.1188 2.97092 18.6466 2.935 18.142L2.002 5.072L2 5H1C0.734784 5 0.48043 4.89464 0.292893 4.70711C0.105357 4.51957 0 4.26522 0 4C0 3.73478 0.105357 3.48043 0.292893 3.29289C0.48043 3.10536 0.734784 3 1 3H17ZM11 0C11.2652 0 11.5196 0.105357 11.7071 0.292893C11.8946 0.48043 12 0.734784 12 1C12 1.26522 11.8946 1.51957 11.7071 1.70711C11.5196 1.89464 11.2652 2 11 2H7C6.73478 2 6.48043 1.89464 6.29289 1.70711C6.10536 1.51957 6 1.26522 6 1C6 0.734784 6.10536 0.48043 6.29289 0.292893C6.48043 0.105357 6.73478 0 7 0H11Z"
        fill={color}
      />
    ),
  },
};

export function Icon({ name, size = 20, color, style }: IconProps) {
  const { colors } = useTheme();
  
  // Remove .svg extension if present
  const iconName = name.replace('.svg', '');
  const icon = iconPaths[iconName];
  
  if (!icon) {
    console.warn(`Icon "${iconName}" not found in icon registry`);
    return null;
  }
  
  // Resolve color: if it's a theme key, use theme color; otherwise use as-is or default to currentColor
  let fillColor = 'currentColor';
  if (color) {
    // Check if it's a theme color key
    if (color in colors) {
      fillColor = colors[color as keyof typeof colors];
    } else {
      // Use as direct color value (hex, rgb, etc.)
      fillColor = color;
    }
  }
  
  return (
    <Svg 
      width={size} 
      height={size} 
      viewBox={icon.viewBox} 
      fill="none" 
      style={style}
    >
      {icon.paths(fillColor)}
    </Svg>
  );
}