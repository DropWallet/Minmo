import React from 'react';
import Svg, { Path, G } from 'react-native-svg';
import { useTheme } from '@hooks/useTheme';

interface IconProps {
  name: string;
  size?: number;
  color?: string; // Can be a theme color key (e.g., 'textPrimary', 'accent') or a hex color
  style?: React.ComponentProps<typeof Svg>['style'];
}

// Convert paths to functions that accept color
const iconPaths: Record<string, { viewBox: string; paths: (color: string) => React.ReactNode }> = {
  'ic-close': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <Path
        d="M3.05288 17.1929C2.09778 16.2704 1.33596 15.167 0.811868 13.9469C0.287778 12.7269 0.0119157 11.4147 0.000377568 10.0869C-0.0111606 8.7591 0.241856 7.44231 0.744665 6.21334C1.24747 4.98438 1.99001 3.86786 2.92893 2.92893C3.86786 1.99001 4.98438 1.24747 6.21334 0.744665C7.44231 0.241856 8.7591 -0.0111606 10.0869 0.000377568C11.4147 0.0119157 12.7269 0.287778 13.9469 0.811868C15.167 1.33596 16.2704 2.09778 17.1929 3.05288C19.0145 4.9389 20.0224 7.46493 19.9996 10.0869C19.9768 12.7089 18.9251 15.217 17.0711 17.0711C15.217 18.9251 12.7089 19.9768 10.0869 19.9996C7.46493 20.0224 4.9389 19.0145 3.05288 17.1929ZM11.5229 10.1229L14.3529 7.29288L12.9429 5.88288L10.1229 8.71288L7.29288 5.88288L5.88288 7.29288L8.71288 10.1229L5.88288 12.9529L7.29288 14.3629L10.1229 11.5329L12.9529 14.3629L14.3629 12.9529L11.5329 10.1229H11.5229Z"
        fill={color}
      />
    ),
  },
  'ic-close-light': {
    viewBox: '0 0 14 14',
    paths: (color) => (
      <Path
        d="M1.4 14L0 12.6L5.6 7L0 1.4L1.4 0L7 5.6L12.6 0L14 1.4L8.4 7L14 12.6L12.6 14L7 8.4L1.4 14Z"
        fill={color}
      />
    ),
  },
  'ic-stop': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <G opacity="0.6">
        <Path
          d="M0 6C0 2.68629 2.68629 0 6 0H14C17.3137 0 20 2.68629 20 6V14C20 17.3137 17.3137 20 14 20H6C2.68629 20 0 17.3137 0 14V6Z"
          fill={color}
        />
      </G>
    ),
  },
  'ic-add': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <Path
        d="M10 0C4.477 0 0 4.477 0 10C0 15.523 4.477 20 10 20C15.523 20 20 15.523 20 10C20 4.477 15.523 0 10 0ZM15 11H11V15H9V11H5V9H9V5H11V9H15V11Z"
        fill={color}
      />
    ),
  },
  'ic-play': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <Path
        d="M10 0C8.02219 0 6.08879 0.58649 4.4443 1.6853C2.79981 2.78412 1.51809 4.3459 0.761209 6.17317C0.00433284 8.00043 -0.193701 10.0111 0.192152 11.9509C0.578004 13.8907 1.53041 15.6725 2.92894 17.0711C4.32746 18.4696 6.10929 19.422 8.0491 19.8079C9.98891 20.1937 11.9996 19.9957 13.8268 19.2388C15.6541 18.4819 17.2159 17.2002 18.3147 15.5557C19.4135 13.9112 20 11.9778 20 10C20 8.68678 19.7413 7.38642 19.2388 6.17317C18.7363 4.95991 17.9997 3.85752 17.0711 2.92893C16.1425 2.00035 15.0401 1.26375 13.8268 0.761205C12.6136 0.258658 11.3132 0 10 0ZM8 14.5V5.5L14 10L8 14.5Z"
        fill={color}
      />
    ),
  },
  'ic-play-slim': {
    viewBox: '0 0 14 14',
    paths: (color) => (
      <Path
        d="M2.5 0.140015V14.14L13.5 7.14002L2.5 0.140015Z"
        fill={color}
      />
    ),
  },
  'ic-pause': {
  viewBox: '0 0 20 20',
  paths: (color) => (
    <Path
      d="M10 0C4.477 0 0 4.477 0 10C0 15.523 4.477 20 10 20C15.523 20 20 15.523 20 10C20 4.477 15.523 0 10 0ZM9 14H7V6H9V14ZM13 14H11V6H13V14Z"
      fill={color}
    />
  ),
},
  'ic-tick': {
    viewBox: '0 0 20 20',
    paths: (color) => (
      <Path
        d="M10 0C4.5 0 0 4.5 0 10C0 15.5 4.5 20 10 20C15.5 20 20 15.5 20 10C20 4.5 15.5 0 10 0ZM8 15L3 10L4.41 8.59L8 12.17L15.59 4.58L17 6L8 15Z"
        fill={color}
      />
    ),
  },
  'ic-edit': {
    viewBox: '0 0 18 20',
    paths: (color) => (
      <Path
        d="M15.675 0.887176C15.3938 0.605833 15.0599 0.382668 14.6924 0.230441C14.325 0.078213 13.9311 -9.27894e-05 13.5333 8.25137e-08C13.1355 9.29544e-05 12.7417 0.0785826 12.3743 0.230982C12.0068 0.383381 11.6731 0.606702 11.392 0.888176L1.885 10.4082C1.31853 10.9759 1.00028 11.7451 1 12.5472V15.7502C1 16.1642 1.336 16.5002 1.75 16.5002H4.973C5.776 16.5002 6.546 16.1802 7.113 15.6132L16.613 6.10718C17.1797 5.53915 17.4979 4.76954 17.4979 3.96718C17.4979 3.16481 17.1797 2.3952 16.613 1.82718L15.675 0.887176ZM0.75 18.0002C0.551088 18.0002 0.360322 18.0792 0.21967 18.2198C0.0790175 18.3605 0 18.5513 0 18.7502C0 18.9491 0.0790175 19.1399 0.21967 19.2805C0.360322 19.4212 0.551088 19.5002 0.75 19.5002H16.75C16.9489 19.5002 17.1397 19.4212 17.2803 19.2805C17.421 19.1399 17.5 18.9491 17.5 18.7502C17.5 18.5513 17.421 18.3605 17.2803 18.2198C17.1397 18.0792 16.9489 18.0002 16.75 18.0002H0.75Z"
        fill={color}
      />
    ),
  },
  'ic-delete': {
    viewBox: '0 0 18 20',
    paths: (color) => (
      <Path
        d="M17 3C17.2652 3 17.5196 3.10536 17.7071 3.29289C17.8946 3.48043 18 3.73478 18 4C18 4.26522 17.8946 4.51957 17.7071 4.70711C17.5196 4.89464 17.2652 5 17 5H16L15.997 5.071L15.064 18.142C15.0281 18.6466 14.8023 19.1188 14.4321 19.4636C14.0619 19.8083 13.5749 20 13.069 20H4.93C4.42414 20 3.93707 19.8083 3.56688 19.4636C3.1967 19.1188 2.97092 18.6466 2.935 18.142L2.002 5.072L2 5H1C0.734784 5 0.48043 4.89464 0.292893 4.70711C0.105357 4.51957 0 4.26522 0 4C0 3.73478 0.105357 3.48043 0.292893 3.29289C0.48043 3.10536 0.734784 3 1 3H17ZM11 0C11.2652 0 11.5196 0.105357 11.7071 0.292893C11.8946 0.48043 12 0.734784 12 1C12 1.26522 11.8946 1.51957 11.7071 1.70711C11.5196 1.89464 11.2652 2 11 2H7C6.73478 2 6.48043 1.89464 6.29289 1.70711C6.10536 1.51957 6 1.26522 6 1C6 0.734784 6.10536 0.48043 6.29289 0.292893C6.48043 0.105357 6.73478 0 7 0H11Z"
        fill={color}
      />
    ),
  },
  'ic-tab-feed': {
    viewBox: '0 0 26 26',
    paths: (color) => (
      <Path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M10.5439 3.64374C11.9884 2.52028 14.0116 2.52028 15.4561 3.64374L21.4561 8.30975C22.4301 9.06749 22.9999 10.2329 23 11.467V21.0002C22.9998 22.6569 21.6567 24.0002 20 24.0002H6C4.34327 24.0002 3.0002 22.6569 3 21.0002V11.467C3.00014 10.2329 3.56986 9.06749 4.54395 8.30975L10.5439 3.64374ZM14.2275 5.22186C13.5054 4.66046 12.4946 4.66046 11.7725 5.22186L5.77246 9.88886C5.28552 10.2677 5.00014 10.85 5 11.467V21.0002C5.0002 21.5523 5.44784 22.0002 6 22.0002H9.03516C9.015 21.4479 9 20.7812 9 20.0002C9 18.8651 9.02977 17.9714 9.06445 17.3195C9.10214 16.6113 9.65801 16.0717 10.3506 16.007L10.4912 16.0002H15.5088C16.2653 16.0002 16.8953 16.5641 16.9355 17.3195C16.9702 17.9714 17 18.8651 17 20.0002C17 20.7812 16.985 21.4479 16.9648 22.0002H20C20.5522 22.0002 20.9998 21.5523 21 21.0002V11.467C20.9999 10.85 20.7145 10.2677 20.2275 9.88886L14.2275 5.22186ZM11.04 18.0002C11.0193 18.5416 11 19.2083 11 20.0002C11 20.7921 11.0164 21.4588 11.0371 22.0002H14.9629C14.9836 21.4588 15 20.7921 15 20.0002C15 19.2083 14.9807 18.5416 14.96 18.0002H11.04Z"
        fill={color}
      />
    ),
  },
  'ic-tab-record': {
    viewBox: '0 0 26 26',
    paths: (color) => (
      <Path
        d="M14 11H22C22.5523 11 23 11.4477 23 12C23 12.5523 22.5523 13 22 13H14V21C14 21.5523 13.5523 22 13 22C12.4477 22 12 21.5523 12 21V13H4C3.44772 13 3 12.5523 3 12C3 11.4477 3.44772 11 4 11H12V3C12 2.44772 12.4477 2 13 2C13.5523 2 14 2.44772 14 3V11Z"
        fill={color}
      />
    ),
  },
  'ic-tab-saved': {
    viewBox: '0 0 26 26',
    paths: (color) => (
      <Path
        d="M21 13C21 9.88765 20.8041 6.76708 20.6582 4.87891C20.6201 4.38712 20.207 4.0002 19.6904 4H6.30957C5.79302 4.0002 5.37991 4.38712 5.3418 4.87891C5.19587 6.76708 5 9.88765 5 13C5 16.1441 5.20036 19.2961 5.34668 21.1777L11.2695 16.9971C12.3067 16.2649 13.6933 16.2649 14.7305 16.9971L20.6523 21.1777C20.7987 19.2961 21 16.1441 21 13ZM23 13C23 16.2397 22.7929 19.4717 22.6445 21.3721C22.5228 22.927 20.7667 23.7062 19.5225 22.8281L13.5771 18.6309C13.2314 18.3868 12.7686 18.3868 12.4229 18.6309L6.47754 22.8281C5.23332 23.7062 3.47721 22.927 3.35547 21.3721C3.20707 19.4717 3 16.2397 3 13C3 9.81441 3.19991 6.63635 3.34766 4.72461C3.46816 3.16806 4.77168 2.0002 6.30957 2H19.6904C21.2283 2.0002 22.5318 3.16806 22.6523 4.72461C22.8001 6.63635 23 9.81441 23 13Z"
        fill={color}
      />
    ),
  },
  'ic-tab-profile': {
    viewBox: '0 0 26 26',
    paths: (color) => (
      <>
        <Path
          d="M13 6C14.6249 6 15.9751 7.24641 15.9961 8.87109C15.9987 9.07392 16 9.28428 16 9.5C16 9.71572 15.9987 9.92608 15.9961 10.1289C15.9751 11.7536 14.6249 13 13 13C11.3751 13 10.0249 11.7536 10.0039 10.1289C10.0013 9.92608 10 9.71572 10 9.5C10 9.28428 10.0013 9.07392 10.0039 8.87109C10.0249 7.24641 11.3751 6 13 6Z"
          fill={color}
        />
        <Path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M19.9385 2C21.3191 2.00001 22.5634 2.97223 22.7051 4.44922C22.846 5.9186 23 8.54328 23 13C23 17.4567 22.846 20.0814 22.7051 21.5508C22.5634 23.0278 21.3191 24 19.9385 24H6.06152C4.68085 24 3.43656 23.0278 3.29492 21.5508C3.15402 20.0814 3 17.4567 3 13C3 8.54328 3.15402 5.9186 3.29492 4.44922C3.43656 2.97223 4.68085 2.00001 6.06152 2H19.9385ZM18.8252 20.6484C15.6666 17.2928 10.3334 17.2928 7.1748 20.6484L5.91309 21.9883C5.96035 21.9954 6.00979 22 6.06152 22H19.9385C19.9899 22 20.039 21.9954 20.0859 21.9883L18.8252 20.6484ZM6.06152 4C5.60691 4.00001 5.31987 4.28973 5.28613 4.63965C5.15309 6.02697 5 8.58499 5 13C5 16.1459 5.07808 18.3489 5.1709 19.8574L5.71777 19.2783C9.66614 15.0832 16.3339 15.0832 20.2822 19.2783L20.8281 19.8574C20.9209 18.3489 21 16.1459 21 13C21 8.58499 20.8469 6.02697 20.7139 4.63965C20.6801 4.28973 20.3931 4.00001 19.9385 4H6.06152Z"
          fill={color}
        />
      </>
    ),
  },
  'ic-search': {
    viewBox: '0 0 24 24',
    paths: (color) => (
      <>
        <Path
          d="M17 17L21 21"
          stroke={color}
          strokeWidth={1.5}
          strokeLinecap="round"
          strokeLinejoin="round"
          fill="none"
        />
        <Path
          d="M3 11C3 15.4183 6.58172 19 11 19C13.213 19 15.2161 18.1015 16.6644 16.6493C18.1077 15.2022 19 13.2053 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11Z"
          stroke={color}
          strokeWidth={1.5}
          strokeLinecap="round"
          strokeLinejoin="round"
          fill="none"
        />
      </>
    ),
  },
  'ic-grid': {
    viewBox: '0 0 16 16',
    paths: (color) => (
      <>
        <Path
          d="M2.5 2.5L6.5 2.5L6.5 6.5L2.5 6.5Z"
          stroke={color}
          strokeWidth={1}
          fill="none"
        />
        <Path
          d="M2.5 9.5L6.5 9.5L6.5 13.5L2.5 13.5Z"
          stroke={color}
          strokeWidth={1}
          fill="none"
        />
        <Path
          d="M9.5 2.5L13.5 2.5L13.5 6.5L9.5 6.5Z"
          stroke={color}
          strokeWidth={1}
          fill="none"
        />
        <Path
          d="M9.5 9.5L13.5 9.5L13.5 13.5L9.5 13.5Z"
          stroke={color}
          strokeWidth={1}
          fill="none"
        />
      </>
    ),
  },
  'ic-list': {
    viewBox: '0 0 16 16',
    paths: (color) => (
      <>
        <Path
          d="M2.5 2.5L13.5 2.5L13.5 6.5L2.5 6.5Z"
          stroke={color}
          strokeWidth={1}
          fill="none"
        />
        <Path
          d="M2.5 9.5L13.5 9.5L13.5 13.5L2.5 13.5Z"
          stroke={color}
          strokeWidth={1}
          fill="none"
        />
      </>
    ),
  },
  'ic-card': {
    viewBox: '0 0 16 16',
    paths: (color) => (
      <Path
        d="M3.5 2.5L12.5 2.5L12.5 13.5L3.5 13.5Z"
        stroke={color}
        strokeWidth={1}
        fill="none"
      />
    ),
  },
};

export function Icon({ name, size = 20, color, style }: IconProps) {
  const { colors } = useTheme();
  
  // Remove .svg extension if present
  const iconName = name.replace('.svg', '');
  const icon = iconPaths[iconName];
  
  if (!icon) {
    console.warn(`Icon "${iconName}" not found in icon registry`);
    return null;
  }
  
  // Resolve color: if it's a theme key, use theme color; otherwise use as-is or default to currentColor
  let fillColor = 'currentColor';
  if (color) {
    // Check if it's a theme color key
    if (color in colors) {
      fillColor = colors[color as keyof typeof colors];
    } else {
      // Use as direct color value (hex, rgb, etc.)
      fillColor = color;
    }
  }
  
  return (
    <Svg 
      width={size} 
      height={size} 
      viewBox={icon.viewBox} 
      fill="none" 
      style={style}
    >
      {icon.paths(fillColor)}
    </Svg>
  );
}